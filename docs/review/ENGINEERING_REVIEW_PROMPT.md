# Chrome Extension Debug MCP - å·¥ç¨‹å®¡æŸ¥ Prompt

**ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-26  
**ç›®çš„**: ç³»ç»ŸåŒ–å®¡æŸ¥é¡¹ç›®å¼€å‘æ˜¯å¦ç¬¦åˆå·¥ç¨‹è§„èŒƒã€æ•ˆç‡ã€é«˜æ•ˆã€ä¼˜é›…ç­‰æ ‡å‡†

---

## ğŸ“‹ å®¡æŸ¥æ¸…å•æ¦‚è§ˆ

æœ¬promptç”¨äºå®¡æŸ¥ Chrome Extension Debug MCP é¡¹ç›®çš„å¼€å‘è´¨é‡ã€‚å®¡æŸ¥åˆ†ä¸º7ä¸ªç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦åŒ…å«å…·ä½“çš„æ£€æŸ¥é¡¹å’Œè¯„åˆ†æ ‡å‡†ã€‚

### å®¡æŸ¥ç»´åº¦

1. **ä»£ç è®¾è®¡æ¨¡å¼** (30%) - æ˜¯å¦éµå¾ªç¬¬ä¸€æ€§åŸç†å’Œå…­å¤§è®¾è®¡åŸåˆ™
2. **é”™è¯¯å¤„ç†è§„èŒƒ** (25%) - ä¸šåŠ¡å¤±è´¥å¤„ç†æ˜¯å¦ç¬¦åˆæ ‡å‡†
3. **å·¥å…·å¼€å‘æ ‡å‡†** (15%) - æ–°å·¥å…·æ˜¯å¦ç¬¦åˆæ¨¡å¼
4. **æ¶æ„ä¸€è‡´æ€§** (10%) - ä»£ç æ˜¯å¦ä¿æŒç»Ÿä¸€é£æ ¼
5. **æ€§èƒ½ä¸æ•ˆç‡** (10%) - æ˜¯å¦é¿å…è¿‡åº¦å·¥ç¨‹åŒ–
6. **æ–‡æ¡£è´¨é‡** (5%) - æ–‡æ¡£æ˜¯å¦æ¸…æ™°å®Œæ•´
7. **æµ‹è¯•è¦†ç›–** (5%) - æ˜¯å¦æœ‰å……åˆ†æµ‹è¯•

---

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### ç¬¬ä¸€æ€§åŸç† â­â­â­â­â­

**å·¥å…·è°ƒç”¨åº”è¯¥æ°¸è¿œæˆåŠŸï¼Œåªæœ‰ç»“æœå¯ä»¥å¤±è´¥**

```typescript
// âŒ é”™è¯¯ï¼šä¸šåŠ¡å¤±è´¥æŠ›å¼‚å¸¸ â†’ MCPå´©æºƒ
if (!extension) {
  throw new Error('Extension not found');
}

// âœ… æ­£ç¡®ï¼šä¸šåŠ¡å¤±è´¥è¿”å›ä¿¡æ¯ â†’ AIç»§ç»­å¹¶è‡ªåŠ¨ä¿®æ­£
if (!extension) {
  reportExtensionNotFound(response, extensionId, availableExtensions);
  response.setIncludePages(true);
  return; // AIå¯ä»¥ç»§ç»­
}
```

### å…­å¤§è®¾è®¡åŸåˆ™

1. **æç®€ä¸»ä¹‰** - ä¸€è¡Œä»£ç èƒ½å®Œæˆçš„ä¸å†™ä¸¤è¡Œ
2. **é˜²å¾¡ç¼–ç¨‹** - é¢„æœŸé”™è¯¯å¿…é¡»æ•è·ï¼Œæ„å¤–é”™è¯¯ç»§ç»­æŠ›å‡º
3. **å‚æ•°éªŒè¯ä¼˜å…ˆ** - åœ¨handlerå¼€å¤´éªŒè¯ï¼Œå‚æ•°é”™è¯¯ç«‹å³æŠ›å‡º
4. **èŒè´£å•ä¸€** - ä¸€ä¸ªå·¥å…·åªåšä¸€ä»¶äº‹
5. **ä¸šåŠ¡å¤±è´¥ä¸æŠ›å¼‚å¸¸** - åŒºåˆ†Exceptionå’ŒFailure
6. **æ˜ç¡®å‰¯ä½œç”¨** - ä½¿ç”¨readOnlyHintæ ‡è®°

---

## 1ï¸âƒ£ ä»£ç è®¾è®¡æ¨¡å¼ (30åˆ†)

### 1.1 ç¬¬ä¸€æ€§åŸç†éµå¾ªåº¦ â­â­â­â­â­

**æ£€æŸ¥å‘½ä»¤**:

```bash
# æ£€æŸ¥æ˜¯å¦æœ‰ä¸šåŠ¡å¼‚å¸¸æœªå¤„ç†
grep -r "throw new Error" src/tools/extension/ | grep -v "Parameter validation" | grep -v "// "
```

**è¯„åˆ†æ ‡å‡†**:

- **ä¼˜ç§€ (27-30åˆ†)**: 100%ä¸šåŠ¡å¤±è´¥è¿”å›ä¿¡æ¯ï¼Œ0%æŠ›å¼‚å¸¸
- **è‰¯å¥½ (24-26åˆ†)**: >90%ç¬¦åˆæ ‡å‡†ï¼Œå°‘æ•°é—ç•™é—®é¢˜
- **åŠæ ¼ (21-23åˆ†)**: >70%ç¬¦åˆæ ‡å‡†ï¼Œéœ€è¦æ”¹è¿›
- **ä¸åŠæ ¼ (<21åˆ†)**: <70%ç¬¦åˆæ ‡å‡†ï¼Œå¤§é‡æŠ›å¼‚å¸¸

### 1.2 é»„é‡‘æ ‡å‡† - close_pageæ¨¡å¼

**å‚è€ƒæ–‡ä»¶**: `src/tools/pages.ts`

```typescript
// å®šä¹‰é”™è¯¯å¸¸é‡
const CLOSE_PAGE_ERROR = 'Cannot close the last page';

export const closePage = defineTool({
  handler: async (request, response, context) => {
    try {
      await context.closePage(request.params.pageIdx);
    } catch (err) {
      if (err.message === CLOSE_PAGE_ERROR) {
        // é¢„æœŸçš„ä¸šåŠ¡å¤±è´¥ â†’ è¿”å›ä¿¡æ¯
        response.appendResponseLine(err.message);
      } else {
        // æ„å¤–çš„ç³»ç»Ÿé”™è¯¯ â†’ ç»§ç»­æŠ›å‡º
        throw err;
      }
    }
    response.setIncludePages(true);
  },
});
```

**æ£€æŸ¥æ¸…å•**:

- [ ] å®šä¹‰é”™è¯¯å¸¸é‡
- [ ] try-catchæ•è·ç‰¹å®šé”™è¯¯
- [ ] é¢„æœŸé”™è¯¯è¿”å›ä¿¡æ¯
- [ ] æ„å¤–é”™è¯¯ç»§ç»­æŠ›å‡º
- [ ] setIncludePagesåœ¨åˆé€‚ä½ç½®

### 1.3 å…­å¤§åŸåˆ™å®æ–½æ£€æŸ¥

#### åŸåˆ™1: æç®€ä¸»ä¹‰

```typescript
// âœ… ä¼˜ç§€ - å§”æ‰˜ç»™MCPå±‚
handler: async (_request, response) => {
  response.setIncludePages(true);
};

// âŒ é”™è¯¯ - æ‰‹åŠ¨æ‹¼æ¥50+è¡Œ
handler: async (_request, response) => {
  let output = '# Pages\n';
  for (const page of pages) {
    output += `## Page ${page.index}\n`;
    // ... 50+ lines
  }
};
```

**è¯„åˆ†**: handler < 50è¡Œ(5åˆ†), < 100è¡Œ(3åˆ†), > 100è¡Œ(0åˆ†)

#### åŸåˆ™2: é˜²å¾¡ç¼–ç¨‹

**æ£€æŸ¥é¡¹**:

- [ ] å®šä¹‰é”™è¯¯å¸¸é‡ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ•è·ç‰¹å®šé”™è¯¯ï¼ˆä¸ç›²ç›®catch allï¼‰
- [ ] æ„å¤–é”™è¯¯ç»§ç»­æŠ›å‡º

#### åŸåˆ™3: å‚æ•°éªŒè¯ä¼˜å…ˆ

**æ ‡å‡†Handlerç»“æ„**:

```typescript
handler: async (request, response, context) => {
  // 1ï¸âƒ£ å‚æ•°éªŒè¯(åœ¨å¼€å¤´ï¼ŒæŠ›å¼‚å¸¸)
  if (conflictingParams) {
    throw new Error('Parameter conflict');
  }

  // 2ï¸âƒ£ è·å–èµ„æº(æ•è·ä¸šåŠ¡å¤±è´¥ï¼Œè¿”å›ä¿¡æ¯)
  const resource = await getResource();
  if (!resource) {
    reportResourceNotFound(response);
    return;
  }

  // 3ï¸âƒ£ æ‰§è¡Œæ“ä½œ
  await doSomething(resource);

  // 4ï¸âƒ£ è®¾ç½®è¾“å‡º
  response.setIncludePages(true);
};
```

**è¯„åˆ†**: å®Œå…¨ç¬¦åˆ(5åˆ†), åŸºæœ¬ç¬¦åˆ(3åˆ†), ä¸ç¬¦åˆ(0åˆ†)

#### åŸåˆ™4: èŒè´£å•ä¸€

**æ£€æŸ¥é¡¹**:

- [ ] å·¥å…·åç§°æ¸…æ™°ï¼ˆåŠ¨è¯+åè¯ï¼‰
- [ ] åªåšä¸€ä»¶äº‹
- [ ] ä¸æ··åˆå¤šä¸ªèŒè´£ï¼ˆå¦‚reload_and_clearï¼‰

#### åŸåˆ™5: ä¸šåŠ¡å¤±è´¥ä¸æŠ›å¼‚å¸¸

**æ ¸å¿ƒåŒºåˆ«**:

- **å¼‚å¸¸(Exception)**: è°ƒç”¨è€…æ— æ³•é¢„æœŸçš„é”™è¯¯ï¼ˆå‚æ•°ç±»å‹é”™è¯¯ï¼‰
- **å¤±è´¥(Failure)**: æ“ä½œæœªè¾¾ç›®æ ‡ä½†å¯é¢„æœŸï¼ˆèµ„æºä¸å­˜åœ¨ï¼‰

**æ£€æŸ¥é¡¹**:

- [ ] èµ„æºä¸å­˜åœ¨ â†’ è¿”å›ä¿¡æ¯ï¼ˆä¸æŠ›å¼‚å¸¸ï¼‰
- [ ] å‰ç½®æ¡ä»¶ä¸æ»¡è¶³ â†’ è¿”å›ä¿¡æ¯+å»ºè®®
- [ ] æ“ä½œè¶…æ—¶ â†’ è¿”å›ä¿¡æ¯
- [ ] å‚æ•°é”™è¯¯ â†’ å…è®¸æŠ›å¼‚å¸¸

#### åŸåˆ™6: æ˜ç¡®å‰¯ä½œç”¨

**æ£€æŸ¥é¡¹**:

- [ ] æ‰€æœ‰å·¥å…·éƒ½æœ‰readOnlyHintæ ‡è®°
- [ ] è¯»æ“ä½œ=true, å†™æ“ä½œ=false
- [ ] æ ‡è®°å‡†ç¡®æ— è¯¯

---

## 2ï¸âƒ£ é”™è¯¯å¤„ç†è§„èŒƒ (25åˆ†)

### 2.1 ç»Ÿä¸€é”™è¯¯å¤„ç†æ¡†æ¶ (10åˆ†)

**æ£€æŸ¥æ–‡ä»¶**:

- `src/tools/extension/errors.ts` - é”™è¯¯å¸¸é‡
- `src/tools/utils/ErrorReporting.ts` - æŠ¥å‘Šå‡½æ•°

**åº”è¯¥å­˜åœ¨çš„å¸¸é‡**:

```typescript
export const EXTENSION_NOT_FOUND = 'EXTENSION_NOT_FOUND';
export const NO_BACKGROUND_CONTEXT = 'NO_BACKGROUND_CONTEXT';
export const RELOAD_TIMEOUT = 'RELOAD_TIMEOUT';
// ... å…¶ä»–
```

**åº”è¯¥å­˜åœ¨çš„æŠ¥å‘Šå‡½æ•°**:

```typescript
reportExtensionNotFound(response, extensionId, availableExtensions);
reportNoBackgroundContext(response, extensionId);
reportTimeout(response, operationName, elapsed, limit);
```

**è¯„åˆ†**:

- æœ‰ç»Ÿä¸€æ¡†æ¶(10åˆ†)
- éƒ¨åˆ†ä½¿ç”¨(5åˆ†)
- æ— æ¡†æ¶(0åˆ†)

### 2.2 Catchå—ç®€æ´æ€§ (8åˆ†)

**æ ‡å‡†æ¨¡å¼** (æ¥è‡ªnavigate_page_history):

```typescript
try {
  await page.goBack();
} catch {} // ç©ºcatch

response.appendResponseLine('Navigation completed');
```

**è¯„åˆ†æ ‡å‡†**:

- Catchå—å¹³å‡<5è¡Œ(8åˆ†)
- <10è¡Œ(5åˆ†)
- > 10è¡Œ(0åˆ†)

### 2.3 Tryå—èŒƒå›´æœ€å°åŒ– (7åˆ†)

**æ­£ç¡®ç¤ºä¾‹**:

```typescript
// è·å–èµ„æº(ä¸éœ€è¦try-catch)
const extension = await getExtension(id);
if (!extension) {
  reportExtensionNotFound(response, id);
  return;
}

// åªåŒ…è£¹çœŸæ­£å±é™©çš„æ“ä½œ
try {
  await context.reloadExtension(id);
} catch (err) {
  if (err.message === RELOAD_TIMEOUT) {
    reportTimeout(response, 'Reload', elapsed, limit);
    return;
  }
  throw err;
}
```

**è¯„åˆ†**: åªåŒ…å«å¿…è¦æ“ä½œ(7åˆ†), åŒ…å«éƒ¨åˆ†ä¸å¿…è¦æ“ä½œ(3åˆ†), è¿‡å¤§(0åˆ†)

---

## 3ï¸âƒ£ å·¥å…·å¼€å‘æ ‡å‡† (15åˆ†)

### 3.1 å·¥å…·æè¿°è§„èŒƒ (5åˆ†)

**é•¿åº¦æ ‡å‡†**: 12-20è¡Œä¸ºæœ€ä½³

**ä¼˜ç§€æè¿°ç»“æ„**:

```typescript
description: `List all installed Chrome extensions.

**ğŸ¯ For AI: START HERE** - First tool for extension debugging.

**Returns**:
- Extension ID (required for ALL other tools)
- Service Worker status: ğŸŸ¢ Active / ğŸ”´ Inactive

**Typical workflow**:
1. \`list_extensions\` â†’ Get ID and check SW status
2. If ğŸ”´ Inactive â†’ \`activate_extension_service_worker\`
3. Then proceed with other tools

**Related tools**: \`activate_extension_service_worker\``,
```

**å¿…éœ€å…ƒç´ **:

- [ ] ğŸ¯ AIæ ‡è®°
- [ ] åŠŸèƒ½è¯´æ˜
- [ ] å…¸å‹å·¥ä½œæµ
- [ ] ç›¸å…³å·¥å…·

**è¯„åˆ†**: 12-20è¡Œä¸”ç»“æ„å®Œæ•´(5åˆ†), 20-30è¡Œ(3åˆ†), >30è¡Œæˆ–ç»“æ„ä¸å®Œæ•´(0åˆ†)

### 3.2 Handlerç»“æ„è§„èŒƒ (5åˆ†)

**æ£€æŸ¥é¡¹**:

- [ ] å‚æ•°éªŒè¯åœ¨å¼€å¤´
- [ ] é€»è¾‘é¡ºåºæ¸…æ™°ï¼ˆéªŒè¯â†’è·å–â†’æ‰§è¡Œï¼‰
- [ ] æ— æ··ä¹±è·³è½¬

### 3.3 èµ„æºç®¡ç† (5åˆ†)

**æ ‡å‡†**: éœ€è¦æ¸…ç†çš„èµ„æºä½¿ç”¨try-finally

```typescript
const client = await browser.createCDPSession();
try {
  await client.send('Input.dispatchKeyEvent', {...});
} finally {
  void client.detach(); // ç¡®ä¿é‡Šæ”¾
}
```

**æ£€æŸ¥é¡¹**:

- [ ] CDP Sessionä½¿ç”¨finally
- [ ] æ–‡ä»¶å¥æŸ„æ­£ç¡®å…³é—­
- [ ] äº‹ä»¶ç›‘å¬å™¨æ­£ç¡®æ¸…ç†

---

## 4ï¸âƒ£ æ¶æ„ä¸€è‡´æ€§ (10åˆ†)

### 4.1 ä»£ç æ¨¡å¼ä¸€è‡´æ€§ (7åˆ†)

**æ£€æŸ¥é¡¹**:

- [ ] æ‰€æœ‰æ‰©å±•å·¥å…·éµå¾ªåŸå§‹å·¥å…·æ¨¡å¼
- [ ] é”™è¯¯å¤„ç†ç»Ÿä¸€ä½¿ç”¨ErrorReporting
- [ ] æ‰€æœ‰å·¥å…·æœ‰readOnlyHint
- [ ] setIncludePagesä½ç½®ç»Ÿä¸€

**å®¡æŸ¥å‘½ä»¤**:

```bash
# æ£€æŸ¥readOnlyHint
grep -r "defineTool" src/tools/ | wc -l
grep -r "readOnlyHint" src/tools/ | wc -l
# ä¸¤ä¸ªæ•°å­—åº”è¯¥ç›¸ç­‰
```

### 4.2 æ–‡ä»¶ç»„ç»‡ (3åˆ†)

**æ ‡å‡†ç»“æ„**:

```
src/tools/
â”œâ”€â”€ extension/          # æ‰©å±•å·¥å…·
â”‚   â”œâ”€â”€ discovery.ts    # å‘ç°ç±»
â”‚   â”œâ”€â”€ execution.ts    # æ‰§è¡Œç±»
â”‚   â”œâ”€â”€ contexts.ts     # ä¸Šä¸‹æ–‡ç±»
â”‚   â”œâ”€â”€ errors.ts       # é”™è¯¯å¸¸é‡
â”‚   â””â”€â”€ index.ts        # å¯¼å‡º
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ ErrorReporting.ts
â””â”€â”€ ...
```

**æ£€æŸ¥é¡¹**:

- [ ] æŒ‰åŠŸèƒ½åˆ†ç±»
- [ ] æ–‡ä»¶èŒè´£å•ä¸€
- [ ] å¯¼å‡ºç»Ÿä¸€ç®¡ç†

---

## 5ï¸âƒ£ æ€§èƒ½ä¸æ•ˆç‡ (10åˆ†)

### 5.1 é¿å…è¿‡åº¦å·¥ç¨‹åŒ– (4åˆ†)

**æ£€æŸ¥å‘½ä»¤**:

```bash
# æ£€æŸ¥handlerè¡Œæ•°åˆ†å¸ƒ
find src/tools -name "*.ts" -exec grep -c "handler:" {} \; | sort -rn
```

**è¯„åˆ†**: å¹³å‡<50è¡Œ(4åˆ†), <100è¡Œ(2åˆ†), >100è¡Œ(0åˆ†)

### 5.2 ä»£ç å¤ç”¨ (3åˆ†)

**æ£€æŸ¥é¡¹**:

- [ ] é”™è¯¯å¤„ç†ä½¿ç”¨ç»Ÿä¸€å‡½æ•°
- [ ] æ—¥å¿—æ•è·ä½¿ç”¨ç»Ÿä¸€å‡½æ•°
- [ ] å¸¸ç”¨éªŒè¯é€»è¾‘æŠ½å–ä¸ºhelper

### 5.3 æ™ºèƒ½ç‰¹æ€§ (3åˆ†)

**ç¤ºä¾‹**: reload_extensionçš„ç¼“å­˜ç­–ç•¥

```typescript
cacheStrategy: 'auto' | 'force-clear' | 'preserve' | 'disable';
```

**æ£€æŸ¥é¡¹**:

- [ ] æœ‰æ™ºèƒ½ç­–ç•¥ï¼ˆå¦‚é€‚ç”¨ï¼‰
- [ ] æä¾›ç”¨æˆ·æ§åˆ¶
- [ ] é»˜è®¤å€¼åˆç†

---

## 6ï¸âƒ£ æ–‡æ¡£è´¨é‡ (5åˆ†)

### 6.1 ä»£ç æ³¨é‡Š (3åˆ†)

**å¥½çš„æ³¨é‡Š**:

```typescript
// Following close_page pattern: return info instead of throwing
if (!extension) {
  reportExtensionNotFound(response, extensionId);
  return;
}
```

**è¯„åˆ†**: å…³é”®é€»è¾‘æœ‰æ³¨é‡Š(3åˆ†), éƒ¨åˆ†æœ‰(1åˆ†), æ— æ³¨é‡Š(0åˆ†)

### 6.2 å·¥å…·æ–‡æ¡£ (2åˆ†)

**å¿…éœ€æ–‡æ¡£**:

- [ ] æ ¸å¿ƒå·¥å…·æœ‰ä½¿ç”¨æŒ‡å—
- [ ] æœ‰æ¶æ„æ–‡æ¡£
- [ ] æœ‰æ•…éšœæ’æŸ¥æŒ‡å—

---

## 7ï¸âƒ£ æµ‹è¯•è¦†ç›– (5åˆ†)

### 7.1 å•å…ƒæµ‹è¯• (3åˆ†)

**æ£€æŸ¥å‘½ä»¤**:

```bash
npm test
```

**è¯„åˆ†**: >80%è¦†ç›–ç‡(3åˆ†), >60%(2åˆ†), <60%(0åˆ†)

### 7.2 é›†æˆæµ‹è¯• (2åˆ†)

**åº”è¯¥æœ‰çš„æµ‹è¯•åœºæ™¯**:

- [ ] æ‰©å±•è°ƒè¯•å®Œæ•´æµç¨‹
- [ ] é”™è¯¯å¤„ç†åœºæ™¯
- [ ] è¾¹ç•Œæ¡ä»¶

---

## ğŸ“Š ç»¼åˆè¯„åˆ†

### è®¡åˆ†è§„åˆ™

| ç»´åº¦         | æ»¡åˆ†    | å¾—åˆ†       |
| ------------ | ------- | ---------- |
| ä»£ç è®¾è®¡æ¨¡å¼ | 30      | \_\_\_     |
| é”™è¯¯å¤„ç†è§„èŒƒ | 25      | \_\_\_     |
| å·¥å…·å¼€å‘æ ‡å‡† | 15      | \_\_\_     |
| æ¶æ„ä¸€è‡´æ€§   | 10      | \_\_\_     |
| æ€§èƒ½ä¸æ•ˆç‡   | 10      | \_\_\_     |
| æ–‡æ¡£è´¨é‡     | 5       | \_\_\_     |
| æµ‹è¯•è¦†ç›–     | 5       | \_\_\_     |
| **æ€»åˆ†**     | **100** | **\_\_\_** |

### ç­‰çº§åˆ’åˆ†

- **A (90-100)**: ä¼˜ç§€ï¼Œå¯ä½œä¸ºæœ€ä½³å®è·µå‚è€ƒ
- **B (80-89)**: è‰¯å¥½ï¼Œç¬¦åˆå·¥ç¨‹æ ‡å‡†
- **C (70-79)**: åŠæ ¼ï¼Œéœ€è¦ä¸€äº›æ”¹è¿›
- **D (60-69)**: ä¸åŠæ ¼ï¼Œéœ€è¦é‡å¤§æ”¹è¿›
- **F (<60)**: ä¸¥é‡ä¸åˆæ ¼ï¼Œéœ€è¦é‡å†™

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå®¡æŸ¥ï¼ˆ5åˆ†é’Ÿï¼‰

```bash
# è¿è¡Œè‡ªåŠ¨åŒ–æ£€æŸ¥
./scripts/quick-review.sh src/tools/extension/new-tool.ts

# æ ¸å¿ƒæ£€æŸ¥é¡¹ï¼š
# 1. ä¸šåŠ¡å¤±è´¥æ˜¯å¦æŠ›å¼‚å¸¸ï¼Ÿ
# 2. æ˜¯å¦æœ‰readOnlyHintï¼Ÿ
# 3. handlerç»“æ„æ˜¯å¦æ¸…æ™°ï¼Ÿ
# 4. æ˜¯å¦ä½¿ç”¨ErrorReportingï¼Ÿ
```

### å®Œæ•´å®¡æŸ¥ï¼ˆ30åˆ†é’Ÿï¼‰

```bash
# 1. é˜…è¯»å„ä¸ªç»´åº¦çš„è¯¦ç»†æ£€æŸ¥æ¸…å•
# 2. é€é¡¹æ£€æŸ¥ä»£ç 
# 3. å¡«å†™å®¡æŸ¥æŠ¥å‘Šï¼ˆä½¿ç”¨REVIEW_REPORT_TEMPLATE.mdï¼‰
# 4. ç»™å‡ºæ”¹è¿›å»ºè®®
```

### è‡ªåŠ¨åŒ–å®¡æŸ¥

```bash
# å…¨å±€å®¡æŸ¥
./scripts/engineering-review.sh --full

# å¢é‡å®¡æŸ¥ï¼ˆåªå®¡æŸ¥å˜æ›´ï¼‰
./scripts/engineering-review.sh --incremental

# ç‰¹å®šæ¨¡å—å®¡æŸ¥
./scripts/engineering-review.sh --module extension
```

---

## âœ… å¿«é€Ÿè‡ªæŸ¥æ¸…å•

æäº¤ä»£ç å‰ï¼Œè¯·ç¡®è®¤ï¼š

### å¿…éœ€é¡¹ï¼ˆ10é¡¹å…¨éƒ¨âœ…ï¼‰

- [ ] **ä¸šåŠ¡å¤±è´¥è¿”å›ä¿¡æ¯**ï¼Œä¸æŠ›å¼‚å¸¸
- [ ] **å‚æ•°éªŒè¯åœ¨handlerå¼€å¤´**
- [ ] **ä½¿ç”¨try-finallyæ¸…ç†èµ„æº**ï¼ˆCDP Sessionç­‰ï¼‰
- [ ] **æœ‰readOnlyHintæ ‡è®°**
- [ ] **handlerç»“æ„æ¸…æ™°**ï¼ˆéªŒè¯â†’è·å–â†’æ‰§è¡Œï¼‰
- [ ] **catchå—ç®€æ´**ï¼ˆ<5è¡Œï¼‰
- [ ] **å·¥å…·æè¿°é€‚ä¸­**ï¼ˆ12-20è¡Œï¼‰
- [ ] **æœ‰é”™è¯¯å¸¸é‡å®šä¹‰**ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] **ä½¿ç”¨ErrorReportingç»Ÿä¸€æŠ¥å‘Š**
- [ ] **æœ‰å•å…ƒæµ‹è¯•**ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰

### æ¨èé¡¹

- [ ] æœ‰é›†æˆæµ‹è¯•
- [ ] æœ‰ä½¿ç”¨æ–‡æ¡£
- [ ] ä»£ç æœ‰å…³é”®æ³¨é‡Š
- [ ] éµå¾ªå‘½åè§„èŒƒ

---

## ğŸ“ˆ è´¨é‡æå‡è·¯å¾„

### Phase 1: åŸºç¡€åˆè§„ï¼ˆå¿…é¡»ï¼‰

1. ä¿®å¤æ‰€æœ‰ä¸šåŠ¡å¼‚å¸¸ â†’ è¿”å›ä¿¡æ¯
2. æ·»åŠ readOnlyHintæ ‡è®°
3. ä½¿ç”¨ErrorReportingç»Ÿä¸€æŠ¥å‘Š
4. å‚æ•°éªŒè¯ç§»åˆ°handlerå¼€å¤´

**ç›®æ ‡**: Cçº§ï¼ˆ70åˆ†ï¼‰

### Phase 2: æ¨¡å¼ä¼˜åŒ–ï¼ˆæ¨èï¼‰

1. ç®€åŒ–catchå—ï¼ˆ<5è¡Œï¼‰
2. æœ€å°åŒ–tryå—èŒƒå›´
3. ç»Ÿä¸€setIncludePagesä½ç½®
4. ä¼˜åŒ–å·¥å…·æè¿°ï¼ˆ12-20è¡Œï¼‰

**ç›®æ ‡**: Bçº§ï¼ˆ80åˆ†ï¼‰

### Phase 3: å“è¶Šå®è·µï¼ˆå¯é€‰ï¼‰

1. æ·»åŠ æ™ºèƒ½ç¼“å­˜ç­–ç•¥
2. å®Œå–„æµ‹è¯•è¦†ç›–
3. ç¼–å†™è¯¦ç»†æ–‡æ¡£
4. ä»£ç æ³¨é‡Šå…³é”®å†³ç­–

**ç›®æ ‡**: Açº§ï¼ˆ90+åˆ†ï¼‰

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä»€ä¹ˆæ—¶å€™å¯ä»¥æŠ›å¼‚å¸¸ï¼Ÿ

**A**: åªæœ‰å‚æ•°éªŒè¯å¤±è´¥æ—¶å¯ä»¥æŠ›å¼‚å¸¸ã€‚ä¸šåŠ¡å¤±è´¥å¿…é¡»è¿”å›ä¿¡æ¯ã€‚

```typescript
// âœ… å¯ä»¥æŠ›å¼‚å¸¸ï¼šå‚æ•°éªŒè¯
if (fullPage && uid) {
  throw new Error('fullPage and uid are mutually exclusive');
}

// âŒ ä¸èƒ½æŠ›å¼‚å¸¸ï¼šèµ„æºä¸å­˜åœ¨
if (!extension) {
  reportExtensionNotFound(response, extensionId);
  return;
}
```

### Q2: readOnlyHintå¦‚ä½•åˆ¤æ–­ï¼Ÿ

**A**:

- `true`: åªè¯»æ“ä½œï¼ˆlist, get, inspect, checkï¼‰
- `false`: å†™æ“ä½œï¼ˆreload, clear, activate, switchï¼‰

### Q3: å·¥å…·æè¿°å¤šé•¿åˆé€‚ï¼Ÿ

**A**: 12-20è¡Œæœ€ä½³ã€‚åŒ…å«ï¼šğŸ¯AIæ ‡è®°ã€åŠŸèƒ½ã€å‰ç½®æ¡ä»¶ã€å·¥ä½œæµã€ç›¸å…³å·¥å…·ã€‚

### Q4: ä½•æ—¶éœ€è¦try-finallyï¼Ÿ

**A**: éœ€è¦æ¸…ç†çš„èµ„æºï¼šCDP Sessionã€æ–‡ä»¶å¥æŸ„ã€äº‹ä»¶ç›‘å¬å™¨ã€‚

### Q5: å¦‚ä½•åŒºåˆ†Exceptionå’ŒFailureï¼Ÿ

**A**:

- **Exception**: è°ƒç”¨è€…æ— æ³•é¢„æœŸï¼ˆå‚æ•°ç±»å‹é”™è¯¯ï¼‰â†’ æŠ›å¼‚å¸¸
- **Failure**: å¯é¢„æœŸçš„å¤±è´¥ï¼ˆèµ„æºä¸å­˜åœ¨ï¼‰â†’ è¿”å›ä¿¡æ¯

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### å†…éƒ¨æ–‡æ¡£

- [é”™è¯¯å¤„ç†ä¿®å¤æŠ¥å‘Š](../archive/error-handling/ERROR_HANDLING_FIX_REPORT.md)
- [ç¬¬ä¸€æ€§åŸç†åˆ†æ](../TOOL_ERROR_HANDLING_ANALYSIS.md)
- [Phase 4ä¼˜åŒ–å®Œæˆ](../PHASE4_OPTIMIZATION_COMPLETE.md)

### æœ€ä½³å®è·µç¤ºä¾‹

**åŸå§‹å·¥å…·**ï¼ˆé»„é‡‘æ ‡å‡†ï¼‰:

- `src/tools/pages.ts` - close_pageæ¨¡å¼
- `src/tools/input.ts` - try-finallyæ¨¡å¼
- `src/tools/navigation.ts` - navigate_page_historyæ¨¡å¼

**æ‰©å±•å·¥å…·**ï¼ˆä¼˜åŒ–åï¼‰:

- `src/tools/extension/execution.ts` - reload_extension
- `src/tools/extension/discovery.ts` - list_extensions
- `src/tools/extension/runtime-errors.ts` - get_extension_runtime_errors

---

## ğŸ“ å­¦ä¹ è·¯å¾„

### æ–°æ‰‹ï¼ˆ0-1å‘¨ï¼‰

1. é˜…è¯»[ç¬¬ä¸€æ€§åŸç†åˆ†æ](../TOOL_ERROR_HANDLING_ANALYSIS.md)
2. å­¦ä¹ close_pageæ¨¡å¼ï¼ˆ`src/tools/pages.ts`ï¼‰
3. å¯¹æ¯”åŸå§‹å·¥å…·vsæ‰©å±•å·¥å…·
4. å®Œæˆç¬¬ä¸€ä¸ªPR

### è¿›é˜¶ï¼ˆ1-2å‘¨ï¼‰

1. ç†è§£å…­å¤§è®¾è®¡åŸåˆ™
2. æŒæ¡ErrorReportingä½¿ç”¨
3. å­¦ä¹ èµ„æºç®¡ç†ï¼ˆtry-finallyï¼‰
4. ä¼˜åŒ–ç°æœ‰å·¥å…·

### ä¸“å®¶ï¼ˆ2å‘¨+ï¼‰

1. è®¾è®¡æ–°å·¥å…·
2. ç¼–å†™æœ€ä½³å®è·µæ–‡æ¡£
3. Code Reviewå…¶ä»–PR
4. æå‡ºæ¶æ„æ”¹è¿›

---

## ğŸ“ åé¦ˆ

å¦‚æœæœ¬promptæœ‰ä¸æ¸…æ¥šæˆ–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œè¯·ï¼š

1. æäº¤Issueï¼šæè¿°é—®é¢˜å’Œå»ºè®®
2. æäº¤PRï¼šç›´æ¥æ”¹è¿›æ–‡æ¡£
3. è®¨è®ºåŒºï¼šä¸å›¢é˜Ÿè®¨è®º

---

**ç‰ˆæœ¬å†å²**:

- v1.0 (2025-10-26): åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºäºPhase 1-4ä¼˜åŒ–ç»éªŒæ€»ç»“

**ç»´æŠ¤è€…**: AI Assistant + Community
