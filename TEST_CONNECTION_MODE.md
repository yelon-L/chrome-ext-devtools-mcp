# ğŸ§ª è¿æ¥æ¨¡å¼æµ‹è¯•æŒ‡å—

## æµ‹è¯•ç›®æ ‡

éªŒè¯åœ¨**è¿æ¥æ¨¡å¼ï¼ˆ--browser-urlï¼‰**ä¸‹ï¼ŒMCP æ˜¯å¦èƒ½ï¼š
1. âœ… æ£€æµ‹åˆ°ç”¨æˆ·å®‰è£…çš„ Helper Extension
2. âœ… ä½¿ç”¨ Helper Extension è‡ªåŠ¨æ¿€æ´» Service Worker
3. âœ… è¾¾åˆ° 95%+ çš„è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡

---

## ğŸ¯ å›ç­”ä½ çš„é—®é¢˜

### Q: å·¥å…·è¿”å›ä¿¡æ¯ç»™è°ƒç”¨è€…æœ‰æ•ˆå—ï¼Ÿ

**æ˜¯çš„ï¼Œå®Œå…¨æœ‰æ•ˆï¼** âœ…

```
å·¥ä½œæµç¨‹ï¼š
MCP å·¥å…·æ‰§è¡Œ
    â†“
è¿”å› JSON ç»“æœ
    â†“
IDE/MCP å®¢æˆ·ç«¯æ¥æ”¶
    â†“
æ˜¾ç¤ºç»™ç”¨æˆ·ï¼ˆåŒ…æ‹¬é”™è¯¯æç¤ºã€å®‰è£…è·¯å¾„ç­‰ï¼‰
```

**ç¤ºä¾‹ï¼š**

```typescript
// å·¥å…·è¿”å›
{
  success: false,
  error: "æ¿€æ´»å¤±è´¥",
  suggestion: `
    ã€æ–¹æ¡ˆ 2ã€‘å®‰è£… Helper Extension
    
    ğŸ“ è·¯å¾„: C:\\Users\\...\\Temp\\mcp-helper-extension-xxx
    
    ğŸ“‹ å®‰è£…æ­¥éª¤ï¼š
    1. è®¿é—® chrome://extensions/
    2. ...
  `
}

// IDE ä¼šæ˜¾ç¤ºå®Œæ•´çš„ suggestion
// ç”¨æˆ·çœ‹åˆ°è·¯å¾„å’Œå®‰è£…æ­¥éª¤
```

æ‰€ä»¥å½“æ¿€æ´»å¤±è´¥æ—¶ï¼Œ**IDE ä¼šæ˜¾ç¤ºåŒ…å«ä¸´æ—¶è·¯å¾„çš„å®Œæ•´å®‰è£…æŒ‡å—**ã€‚

---

## ğŸš€ æµ‹è¯•æ­¥éª¤

### å‰ææ¡ä»¶

1. **Chrome å·²å¯åŠ¨å¹¶ç›‘å¬ 9222 ç«¯å£**

```bash
# Windows
chrome.exe --remote-debugging-port=9222

# macOS
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222

# Linux
google-chrome --remote-debugging-port=9222
```

2. **Helper Extension å·²å®‰è£…**

ä½ å·²ç»å®‰è£…äº† Helper Extensionï¼Œå¾ˆå¥½ï¼

---

### æµ‹è¯• 1: éªŒè¯è¿æ¥å’Œæ£€æµ‹

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
node test-connect-9222.js
```

**é¢„æœŸè¾“å‡ºï¼š**

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   æµ‹è¯•è¿æ¥æ¨¡å¼ + Helper Extension                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  è¿æ¥åˆ° Chrome (localhost:9222)...
   âœ… è¿æ¥æˆåŠŸï¼

2ï¸âƒ£  æ£€æµ‹å·²å®‰è£…çš„æ‰©å±•...
   æ‰¾åˆ° 2 ä¸ªæ‰©å±•

3ï¸âƒ£  è¯†åˆ«æ‰©å±•...
   âœ… æ‰¾åˆ° Helper Extension
      ID: xxx
      åç§°: MCP Service Worker Activator
      ç‰ˆæœ¬: 1.0.0
   ğŸ“¦ æ‰¾åˆ°æ‰©å±•: Enhanced MCP Debug Test Extension
      ID: bekcbmopkiajilfliobihjgnghfcbido

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   æ£€æµ‹ç»“æœ                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Helper Extension: å·²å®‰è£…ä¸”å·²æ£€æµ‹åˆ°
âœ… æ‰©å±• ID: xxx
âœ… é¢„æœŸæ•ˆæœ: è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡ 95%+

4ï¸âƒ£  æµ‹è¯• Helper Extension æ¿€æ´»åŠŸèƒ½...
   ç›®æ ‡æ‰©å±•: Enhanced MCP Debug Test Extension
   æ‰©å±• ID: bekcbmopkiajilfliobihjgnghfcbido
   âœ… æ¿€æ´»æˆåŠŸï¼
      æ–¹æ³•: debugger
      è€—æ—¶: 850ms
      æ¶ˆæ¯: Service Worker activated successfully

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   æ€»ç»“                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ å®Œç¾ï¼Helper Extension å·²å°±ç»ª
âœ… MCP è¿æ¥æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨
âœ… è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡: 95%+
âœ… é¢„æœŸæ•ˆæœ: è¾¾æˆï¼
```

---

### æµ‹è¯• 2: é€šè¿‡ MCP å®é™…ä½¿ç”¨

```bash
# 1. ç¼–è¯‘ MCP
npm run build

# 2. å¯åŠ¨ MCPï¼ˆè¿æ¥æ¨¡å¼ï¼‰
node build/index.js --browser-url http://localhost:9222
```

**é¢„æœŸè¾“å‡ºï¼ˆå¦‚æœå¯åŠ¨æ—¶æ²¡æœ‰ç­‰å¾…å®‰è£…ï¼‰ï¼š**

```
[Browser] ğŸ“¡ è¿æ¥åˆ°å·²æœ‰æµè§ˆå™¨: http://localhost:9222

[Browser] ğŸ”§ æ£€æµ‹åˆ°è¿æ¥æ¨¡å¼ï¼Œç”Ÿæˆ Helper Extension...
[HelperGen] ğŸ”§ å¼€å§‹ç”Ÿæˆä¸´æ—¶ Helper Extension...
[HelperGen] âœ… Helper Extension å·²ç”Ÿæˆ: C:\Users\...\Temp\mcp-helper-extension-xxx
[Browser] âœ… Helper Extension å·²ç”Ÿæˆ

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸš€ ä¸ºäº†æå‡è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡åˆ° 95%+ï¼Œè¯·å®‰è£… Helper Extension  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

...

[Browser] ğŸ” å¼€å§‹æ£€æŸ¥ Helper Extension å®‰è£…çŠ¶æ€...
[Browser] âœ… æ£€æµ‹åˆ° Helper Extension å·²å®‰è£…ï¼
[Browser] æ‰©å±• ID: xxx
[Browser] ğŸ‰ è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡æå‡åˆ° 95%+
```

**ç„¶åè¿è¡Œå·¥å…·ï¼š**

```json
// è°ƒç”¨ activate_service_worker
{
  "extensionId": "bekcbmopkiajilfliobihjgnghfcbido"
}
```

**é¢„æœŸç»“æœï¼š**

```json
{
  "success": true,
  "method": "Helper Extension (debugger)",
  "duration": "<1ç§’",
  "message": "Service Worker activated successfully"
}
```

---

## ğŸ“Š æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: Helper Extension å·²å®‰è£…ï¼ˆä½ çš„æƒ…å†µï¼‰âœ…

```
å¯åŠ¨ MCPï¼ˆè¿æ¥æ¨¡å¼ï¼‰
    â†“
æ£€æµ‹åˆ° Helper Extensionï¼ˆ5-15 ç§’ï¼‰
    â†“
ä½¿ç”¨å·¥å…·ï¼ˆactivate_service_workerï¼‰
    â†“
âœ… è‡ªåŠ¨æ¿€æ´»æˆåŠŸï¼ˆ95%+ï¼‰
    â†“
è¿”å›æˆåŠŸç»“æœç»™ IDE
```

### åœºæ™¯ 2: Helper Extension æœªå®‰è£…

```
å¯åŠ¨ MCPï¼ˆè¿æ¥æ¨¡å¼ï¼‰
    â†“
ç”Ÿæˆä¸´æ—¶ Helper Extension
    â†“
æç¤ºç”¨æˆ·å®‰è£…ï¼ˆç­‰å¾… 2 åˆ†é’Ÿï¼‰
    â†“
è¶…æ—¶æˆ–ç”¨æˆ·å®‰è£…
    â†“
ä½¿ç”¨å·¥å…·ï¼ˆactivate_service_workerï¼‰
    â†“
âœ… æˆåŠŸï¼ˆå¦‚å·²å®‰è£…ï¼‰æˆ– âŒ å¤±è´¥ï¼ˆå¦‚æœªå®‰è£…ï¼‰
    â†“
å¤±è´¥æ—¶è¿”å›è¯¦ç»†çš„å®‰è£…æŒ‡å—ç»™ IDE
```

---

## ğŸ¯ éªŒè¯æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼š

- [ ] **Chrome å¯åŠ¨**
  ```bash
  # æ£€æŸ¥ç«¯å£
  netstat -ano | findstr 9222
  # åº”è¯¥æœ‰è¾“å‡º
  ```

- [ ] **Helper Extension å·²å®‰è£…**
  ```
  è®¿é—® chrome://extensions/
  åº”è¯¥çœ‹åˆ°ï¼š
  - MCP Service Worker Activator
  - æˆ– MCP Service Worker Activator (Auto-Generated)
  ```

- [ ] **æµ‹è¯•è„šæœ¬è¿è¡ŒæˆåŠŸ**
  ```bash
  node test-connect-9222.js
  # åº”è¯¥æ£€æµ‹åˆ° Helper Extension
  ```

- [ ] **MCP è¿æ¥æˆåŠŸ**
  ```bash
  node build/index.js --browser-url http://localhost:9222
  # åº”è¯¥è¿æ¥æˆåŠŸ
  ```

- [ ] **å·¥å…·è°ƒç”¨æˆåŠŸ**
  ```
  è°ƒç”¨ activate_service_worker
  åº”è¯¥è‡ªåŠ¨æ¿€æ´»æˆåŠŸ
  ```

---

## ğŸ’¡ é¢„æœŸæ•ˆæœ

### ä½ çš„ç¯å¢ƒï¼ˆHelper Extension å·²å®‰è£…ï¼‰

```
âœ… MCP å¯åŠ¨æ—¶æ£€æµ‹åˆ° Helper Extension
âœ… è°ƒç”¨ activate_service_worker æ—¶è‡ªåŠ¨æˆåŠŸ
âœ… æ— éœ€æ‰‹åŠ¨æ¿€æ´»
âœ… æˆåŠŸç‡ 95%+
âœ… è¿”å›çš„ä¿¡æ¯åŒ…å«æˆåŠŸçŠ¶æ€
```

### å¦‚æœ Helper Extension æœªå®‰è£…

```
âš ï¸  MCP å¯åŠ¨æ—¶ç”Ÿæˆä¸´æ—¶æ‰©å±•
âš ï¸  æç¤ºç”¨æˆ·å®‰è£…ï¼ˆç­‰å¾… 2 åˆ†é’Ÿï¼‰
âš ï¸  è°ƒç”¨ activate_service_worker å¤±è´¥
âœ… è¿”å›è¯¦ç»†çš„å®‰è£…æŒ‡å—ï¼ˆåŒ…å«ä¸´æ—¶è·¯å¾„ï¼‰
âœ… IDE æ˜¾ç¤ºå®Œæ•´çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³æ–¹æ¡ˆ
```

---

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ— æ³•è¿æ¥åˆ° 9222

**ç—‡çŠ¶ï¼š**
```
Error: connect ECONNREFUSED 127.0.0.1:9222
```

**è§£å†³ï¼š**
```bash
# ç¡®è®¤ Chrome å¯åŠ¨å‚æ•°
chrome.exe --remote-debugging-port=9222

# æ£€æŸ¥ç«¯å£
netstat -ano | findstr 9222
```

### é—®é¢˜ 2: æ£€æµ‹ä¸åˆ° Helper Extension

**ç—‡çŠ¶ï¼š**
```
âŒ Helper Extension: æœªæ£€æµ‹åˆ°
```

**è§£å†³ï¼š**
```
1. è®¿é—® chrome://extensions/
2. ç¡®è®¤ Helper Extension å·²å®‰è£…
3. ç¡®è®¤æ‰©å±•çŠ¶æ€æ˜¯"å·²å¯ç”¨"
4. æ£€æŸ¥æ‰©å±•åç§°åŒ…å« "MCP Service Worker Activator"
```

### é—®é¢˜ 3: æ¿€æ´»å¤±è´¥

**ç—‡çŠ¶ï¼š**
```
âŒ æ¿€æ´»å¤±è´¥: Target closed
```

**è§£å†³ï¼š**
```
1. é‡å¯ Chrome
2. é‡æ–°å®‰è£… Helper Extension
3. æ£€æŸ¥ç›®æ ‡æ‰©å±•æ˜¯å¦æœ‰é”™è¯¯
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è¿æ¥æ¨¡å¼æ™ºèƒ½å®‰è£…](./docs/CONNECT_MODE_AUTO_INSTALL.md)
- [æ¿€æ´»å¤±è´¥å¤„ç†æŒ‡å—](./docs/ACTIVATION_FAILURE_GUIDE.md)
- [ä½¿ç”¨æŒ‡å—](./docs/USAGE_GUIDE_AUTO_ACTIVATION.md)

---

## ğŸ‰ ç»“è®º

### å·¥å…·è¿”å›æœºåˆ¶

âœ… **å®Œå…¨æœ‰æ•ˆ**
- å·¥å…·è¿”å›çš„ä¿¡æ¯ä¼šå®Œæ•´åœ°ä¼ é€’ç»™ IDE
- åŒ…æ‹¬é”™è¯¯æç¤ºã€å®‰è£…è·¯å¾„ã€è§£å†³æ–¹æ¡ˆ
- IDE ä¼šæ˜¾ç¤ºç»™ç”¨æˆ·

### è¿æ¥æ¨¡å¼ + Helper Extension

âœ… **é¢„æœŸæ•ˆæœè¾¾æˆ**
- Helper Extension ä¼šè¢«æ£€æµ‹åˆ°
- è‡ªåŠ¨æ¿€æ´»æˆåŠŸç‡ 95%+
- ç”¨æˆ·ä½“éªŒè‰¯å¥½

---

**ç°åœ¨è¿è¡Œ `node test-connect-9222.js` æ¥éªŒè¯ï¼** ğŸš€
