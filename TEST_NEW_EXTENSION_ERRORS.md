# æµ‹è¯•æ–°æ‰©å±•çš„é”™è¯¯è·å–

**åœºæ™¯**: Chromeä¸­æ–°æ·»åŠ äº†æ‰©å±•ï¼Œç®¡ç†é¡µé¢æ˜¾ç¤ºæœ‰Errorsï¼Œæµ‹è¯•MCPå·¥å…·èƒ½å¦è·å–åˆ°è¿™äº›é”™è¯¯ã€‚

---

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯ä»¥ä¸‹èƒ½åŠ›ï¼š
1. âœ… èƒ½å¦é€šè¿‡ `diagnose_extension_errors` ç›´æ¥çœ‹åˆ°é”™è¯¯
2. âœ… å¦‚æœçœ‹ä¸åˆ°ï¼Œä½¿ç”¨ `enhance_extension_error_capture` åèƒ½å¦æ•è·
3. âœ… å¯¹æ¯”Chromeç®¡ç†é¡µé¢çš„é”™è¯¯å’ŒMCPå·¥å…·çš„é”™è¯¯

---

## ğŸ“‹ åœ¨IDE MCPå®¢æˆ·ç«¯ä¸­æ‰§è¡Œ

### æ­¥éª¤1ï¼šæŸ¥æ‰¾æ–°æ‰©å±•

```json
{
  "name": "list_extensions",
  "arguments": {}
}
```

**ä»è¾“å‡ºä¸­æ‰¾åˆ°**ï¼š
- æœ€è¿‘æ·»åŠ çš„æ‰©å±•
- è®°å½•å…¶æ‰©å±•IDï¼ˆ32ä½å°å†™å­—æ¯ï¼‰

---

### æ­¥éª¤2ï¼šå…ˆå°è¯•ç›´æ¥è¯Šæ–­

```json
{
  "name": "diagnose_extension_errors",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "timeRange": 60,
    "includeWarnings": true
  }
}
```

**è§‚å¯Ÿè¾“å‡º**ï¼š
- âœ… å¦‚æœæ˜¾ç¤ºé”™è¯¯ â†’ æˆåŠŸï¼ï¼ˆè®°å½•é”™è¯¯ä¿¡æ¯ï¼‰
- âŒ å¦‚æœ"No errors detected" â†’ è¿›å…¥æ­¥éª¤3

---

### æ­¥éª¤3ï¼šå¢å¼ºé”™è¯¯æ•è·ï¼ˆå¦‚æœæ­¥éª¤2æ²¡æœ‰å‘ç°é”™è¯¯ï¼‰

#### 3.1 æ¿€æ´»Service Workerï¼ˆMV3æ‰©å±•ï¼‰

```json
{
  "name": "activate_extension_service_worker",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID"
  }
}
```

#### 3.2 æ³¨å…¥é”™è¯¯ç›‘å¬å™¨

```json
{
  "name": "enhance_extension_error_capture",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "captureStackTraces": true
  }
}
```

**é¢„æœŸè¾“å‡º**ï¼š
```markdown
âœ… **Enhancement Complete**

Error listeners have been successfully injected.
**Stack Traces**: Enabled

## What's Captured
- âŒ **Uncaught JavaScript errors**
- ğŸ”´ **Unhandled Promise rejections**
...
```

---

### æ­¥éª¤4ï¼šé‡è½½æ‰©å±•ï¼ˆé‡ç°é”™è¯¯ï¼‰

```json
{
  "name": "reload_extension",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "captureErrors": true
  }
}
```

**åŸç†**ï¼š
- é‡è½½ä¼šé‡æ–°æ‰§è¡Œå¯åŠ¨ä»£ç 
- å¦‚æœChromeç®¡ç†é¡µé¢çš„é”™è¯¯æ˜¯å¯åŠ¨æ—¶å‘ç”Ÿçš„
- é‡è½½ä¼šé‡æ–°è§¦å‘ç›¸åŒçš„é”™è¯¯
- è¿™æ¬¡ä¼šè¢«æˆ‘ä»¬æ³¨å…¥çš„ç›‘å¬å™¨æ•è·

---

### æ­¥éª¤5ï¼šå†æ¬¡è¯Šæ–­

```json
{
  "name": "diagnose_extension_errors",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "timeRange": 1,
    "includeWarnings": true
  }
}
```

**æŸ¥æ‰¾æ ‡è®°**ï¼š
- `[EXTENSION_ERROR]` - è¿™æ˜¯æˆ‘ä»¬æ³¨å…¥çš„ç›‘å¬å™¨æ•è·çš„
- `UNCAUGHT_ERROR` - æœªæ•è·çš„JavaScripté”™è¯¯
- `UNHANDLED_REJECTION` - æœªå¤„ç†çš„Promiseæ‹’ç»

---

### æ­¥éª¤6ï¼šæŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```json
{
  "name": "get_extension_logs",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "level": ["error", "warn"],
    "limit": 50
  }
}
```

---

## ğŸ” å¯¹æ¯”åˆ†æ

### Chromeç®¡ç†é¡µé¢çš„Errors

1. æ‰“å¼€ `chrome://extensions`
2. æ‰¾åˆ°ä½ çš„æ‰©å±•
3. ç‚¹å‡» "Errors" æŒ‰é’®
4. è®°å½•æ‰€æœ‰é”™è¯¯ä¿¡æ¯ï¼š
   - é”™è¯¯ç±»å‹
   - é”™è¯¯æ¶ˆæ¯
   - æ–‡ä»¶ä½ç½®
   - è¡Œå·
   - å †æ ˆè·Ÿè¸ª

### MCPå·¥å…·æ•è·çš„é”™è¯¯

ä»æ­¥éª¤5å’Œ6çš„è¾“å‡ºä¸­è®°å½•ï¼š
- é”™è¯¯æ•°é‡
- é”™è¯¯ç±»å‹
- é”™è¯¯æ¶ˆæ¯
- æ¥æºï¼ˆbackground/content_scriptï¼‰

---

## ğŸ“Š å¯èƒ½çš„æµ‹è¯•ç»“æœ

### ç»“æœAï¼šä¸¤è€…å®Œå…¨ä¸€è‡´ âœ…

Chromeç®¡ç†é¡µé¢æ˜¾ç¤ºï¼š
```
Uncaught TypeError: Cannot read property 'value' of null
at background.js:42:15
```

MCPå·¥å…·æ•è·ï¼š
```json
{
  "type": "UNCAUGHT_ERROR",
  "message": "Cannot read property 'value' of null",
  "filename": "chrome-extension://xxx/background.js",
  "lineno": 42,
  ...
}
```

**ç»“è®º**ï¼šâœ… **MCPå·¥å…·æˆåŠŸæ•è·äº†è¿è¡Œæ—¶é”™è¯¯ï¼**

---

### ç»“æœBï¼šMCPå·¥å…·çœ‹ä¸åˆ° âŒ

Chromeç®¡ç†é¡µé¢æ˜¾ç¤ºï¼š
```
Manifest version 2 is deprecated
```

MCPå·¥å…·ï¼š
```
No errors detected
```

**åŸå› **ï¼šè¿™æ˜¯Manifestè­¦å‘Šï¼Œä¸ä¼šè¾“å‡ºåˆ°console

**è§£å†³æ–¹æ¡ˆ**ï¼š
```json
{
  "name": "inspect_extension_manifest",
  "arguments": {
    "extensionId": "ä½ çš„æ‰©å±•ID",
    "checkMV3Compatibility": true
  }
}
```

---

### ç»“æœCï¼šéƒ¨åˆ†å¯è§ âš ï¸

Chromeç®¡ç†é¡µé¢æ˜¾ç¤º3ä¸ªé”™è¯¯ï¼ŒMCPå·¥å…·åªæ•è·äº†2ä¸ªã€‚

**å¯èƒ½åŸå› **ï¼š
1. **Content Scripté”™è¯¯**ï¼šå‘ç”Ÿåœ¨ç½‘é¡µä¸­ï¼Œä¸åœ¨background
2. **ç‰¹å®šè§¦å‘æ¡ä»¶**ï¼šéœ€è¦ç‰¹å®šæ“ä½œæ‰ä¼šå‘ç”Ÿ
3. **CSPé”™è¯¯**ï¼šå¯èƒ½ä¸ä¼šè¢«consoleæ•è·

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥content scriptæ³¨å…¥
- æ‰‹åŠ¨è§¦å‘æ‰©å±•åŠŸèƒ½
- æŸ¥çœ‹ç‰¹å®šç½‘é¡µçš„console

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

### å…³é”®æŠ€æœ¯é™åˆ¶

| é”™è¯¯ç±»å‹ | Chromeç®¡ç†é¡µé¢ | MCPå·¥å…· | åŸå›  |
|---------|---------------|---------|------|
| **è¿è¡Œæ—¶é”™è¯¯** | âœ… | âœ… (éœ€enhance) | Consoleå¯æ•è· |
| **Promiseæ‹’ç»** | âœ… | âœ… (éœ€enhance) | ç›‘å¬å™¨å¯æ•è· |
| **Manifesté”™è¯¯** | âœ… | âŒ | ä¸åœ¨console |
| **CSPé”™è¯¯** | âœ… | âš ï¸ éƒ¨åˆ† | å–å†³äºå®ç° |
| **å†å²é”™è¯¯** | âœ… | âŒ | CDPæ— æ³•è®¿é—® |

### æ•°æ®æºå·®å¼‚

```
Chromeç®¡ç†é¡µé¢:
â””â”€ chrome.developerPrivate.getExtensionErrors()
   â””â”€ ç§æœ‰APIï¼ŒæŒä¹…åŒ–å­˜å‚¨

MCPå·¥å…·:
â””â”€ CDP Protocol + Consoleç›‘å¬
   â””â”€ å…¬å¼€åè®®ï¼Œä¸´æ—¶å­˜å‚¨
```

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```markdown
# æ‰©å±•é”™è¯¯è·å–æµ‹è¯•æŠ¥å‘Š

**æ‰©å±•åç§°**: _______________
**æ‰©å±•ID**: _______________
**Manifestç‰ˆæœ¬**: MV2 / MV3

## Chromeç®¡ç†é¡µé¢æ˜¾ç¤ºçš„é”™è¯¯

### é”™è¯¯1
- ç±»å‹: _______________
- æ¶ˆæ¯: _______________
- ä½ç½®: _______________

### é”™è¯¯2
...

## MCPå·¥å…·æµ‹è¯•ç»“æœ

### æ­¥éª¤2ï¼ˆç›´æ¥è¯Šæ–­ï¼‰
- [ ] å‘ç°é”™è¯¯
- [ ] æœªå‘ç°é”™è¯¯

### æ­¥éª¤3-5ï¼ˆå¢å¼ºåé‡è½½ï¼‰
- [ ] å‘ç°é”™è¯¯
- [ ] ä»æœªå‘ç°é”™è¯¯

### æ•è·çš„é”™è¯¯è¯¦æƒ…
...

## å¯¹æ¯”åˆ†æ

- âœ… æˆåŠŸæ•è·: _______________
- âŒ æœªèƒ½æ•è·: _______________
- â„¹ï¸ åŸå› åˆ†æ: _______________

## ç»“è®º

MCPå·¥å…·èƒ½å¤Ÿæ•è·çš„é”™è¯¯ç±»å‹ï¼š
- [ ] JavaScriptè¿è¡Œæ—¶é”™è¯¯
- [ ] Promiseæ‹’ç»
- [ ] å…¶ä»–: _______________

æ— æ³•æ•è·çš„é”™è¯¯ç±»å‹ï¼š
- [ ] Manifesté”™è¯¯
- [ ] CSPé”™è¯¯
- [ ] å…¶ä»–: _______________
```

---

## ğŸš€ å¼€å§‹æµ‹è¯•

1. æ‰“å¼€ä½ çš„IDE MCPå®¢æˆ·ç«¯
2. æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
3. è®°å½•æ¯ä¸€æ­¥çš„è¾“å‡º
4. å¯¹æ¯”Chromeç®¡ç†é¡µé¢çš„Errors
5. å¡«å†™æµ‹è¯•æŠ¥å‘Š

**å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹ç¬¬ä¸€æ­¥ï¼š`list_extensions()`**
